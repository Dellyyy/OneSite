<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Видеофон 4:3</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body, html {
            height: 100%;
            width: 100%;
            overflow: hidden;
            background: #000;
            font-family: 'Courier New', monospace;
        }

        .preloader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            cursor: pointer;
        }

        .click-text {
            color: #fff;
            font-size: 32px;
            text-transform: uppercase;
            letter-spacing: 4px;
            text-shadow: 
                2px 2px 0 #000,
                -2px -2px 0 #000,
                2px -2px 0 #000,
                -2px 2px 0 #000;
            opacity: 0;
            animation: fadeIn 2s ease-in-out forwards;
            user-select: none;
        }

        @keyframes fadeIn {
            0% { opacity: 0; transform: scale(0.8); }
            50% { opacity: 0.5; transform: scale(1.05); }
            100% { opacity: 1; transform: scale(1); }
        }

        .video-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            display: none;
            background: #000;
        }

        #video-bg {
            position: absolute;
            top: 50%;
            left: 50%;
            width: auto;
            height: 100%;
            transform: translateX(-50%) translateY(-50%);
            object-fit: contain;
            background: #000;
        }

        /* Черные полосы по бокам для формата 4:3 */
        .video-container::before,
        .video-container::after {
            content: '';
            position: absolute;
            top: 0;
            height: 100%;
            width: calc((100% - (100vh * 4 / 3)) / 2);
            background: #000;
            z-index: 1;
        }

        .video-container::before {
            left: 0;
        }

        .video-container::after {
            right: 0;
        }

        /* Скрываем аудио элемент */
        #audio-element {
            display: none;
        }
    </style>
</head>
<body>
    <div class="preloader" id="preloader">
        <div class="click-text">НАЖМИ ЛКМ</div>
    </div>

    <div class="video-container" id="video-container">
        <!-- ЗАМЕНИТЕ 'video.avi' НА ПУТЬ К ВАШЕМУ ВИДЕО -->
        <video id="video-bg" muted loop playsinline>
            <source src="123.mp4" type="video/mp4">
            <source src="video.avi" type="video/x-msvideo">
            <!-- Добавляем дополнительные форматы для совместимости -->
        </video>
    </div>

    <!-- Аудио элемент для воспроизведения звука -->
    <!-- ЗАМЕНИТЕ 'sound.mp3' НА ПУТЬ К ВАШЕМУ АУДИОФАЙЛУ -->
    <audio id="audio-element" loop>
        <source src="" type="audio/mp3">
    </audio>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const preloader = document.getElementById('preloader');
            const videoContainer = document.getElementById('video-container');
            const video = document.getElementById('video-bg');
            const audio = document.getElementById('audio-element');
            
            // Предзагрузка медиа
            video.load();
            audio.load();
            
            // Функция запуска медиа
            function startMedia() {
                // Скрываем прелоадер
                preloader.style.display = 'none';
                
                // Показываем видео
                videoContainer.style.display = 'block';
                
                // Запускаем видео и звук одновременно
                const playPromise = video.play();
                
                if (playPromise !== undefined) {
                    playPromise.then(() => {
                        // Убираем muted с видео и запускаем звук
                        video.muted = false;
                        audio.play().catch(error => {
                            console.log('Ошибка воспроизведения аудио:', error);
                        });
                    }).catch(error => {
                        console.log('Ошибка воспроизведения видео:', error);
                        // Пробуем запустить без звука, если есть ошибка
                        video.muted = true;
                        video.play();
                    });
                }
            }
            
            // Запуск по клику
            preloader.addEventListener('click', function() {
                startMedia();
            }, { once: true });
            
            // Синхронизация видео и аудио
            function syncMedia() {
                if (!audio.paused) {
                    const videoTime = video.currentTime;
                    const audioDuration = audio.duration;
                    
                    if (audioDuration > 0) {
                        audio.currentTime = videoTime % audioDuration;
                    }
                }
            }
            
            // Обновляем синхронизацию
            video.addEventListener('timeupdate', syncMedia);
            
            // Перезапуск аудио при зацикливании видео
            video.addEventListener('seeked', function() {
                if (!audio.paused) {
                    audio.currentTime = 0;
                }
            });

            // Обработка ошибок загрузки видео
            video.addEventListener('error', function(e) {
                console.error('Ошибка загрузки видео:', e);
                alert('Ошибка загрузки видео. Убедитесь, что файл существует и имеет правильный формат.');
            });
        });
    </script>
</body>
</html>
